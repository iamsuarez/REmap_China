{
    "collab_server" : "",
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n\nlibrary(shiny)\nlibrary(REmap)\n#设置remap包的API 的key:\noptions(remap.ak=\"MY07CLhm3wKi4N2tQ6WP4kzz21BBZagI\")\n#设置百度的API 的key:(这个需要自己申请获得)\noptions(baidumap.key = 'cZOvflqxwQLx3co85TgOZkOEFZQ6IGHL')\n#=====================Data=============================#\nPerson_Count<-data.frame(省份=c(\"北京\",\"天津\",\"上海\",\"重庆\",\"河北\",\n                              \"河南\",\"云南\",\"辽宁\",\"黑龙江\",\"湖南\",\n                              \"安徽\",\"山东\",\"新疆\",\"江苏\",\"浙江\",\n                              \"江西\",\"湖北\",\"广西\",\"甘肃\",\"山西\",\n                              \"内蒙古\",\"陕西\",\"吉林\",\"福建\",\"贵州\",\n                              \"广东\",\"青海\",\"西藏\",\"四川\",\"宁夏\"\n                              ,\"海南\",\"台湾\",\"香港\",\"澳门\"),\n                           客户量=c(seq(100,by=16,length=10),\n                                 seq(200,by=16,length=10),\n                                 seq(1000,by=16,length=10),c(236,654,512,541)))\nMoney_Count<-data.frame(省份=c(\"北京\",\"天津\",\"上海\",\"重庆\",\"河北\",\n                             \"河南\",\"云南\",\"辽宁\",\"黑龙江\",\"湖南\",\n                             \"安徽\",\"山东\",\"新疆\",\"江苏\",\"浙江\",\n                             \"江西\",\"湖北\",\"广西\",\"甘肃\",\"山西\",\n                             \"内蒙古\",\"陕西\",\"吉林\",\"福建\",\"贵州\",\n                             \"广东\",\"青海\",\"西藏\",\"四川\",\"宁夏\"\n                             ,\"海南\",\"台湾\",\"香港\",\"澳门\"),\n                          借贷总额=c(seq(10000,by=2300,length=10),\n                                 seq(20550,by=1600,length=10),\n                                 seq(30000,by=36000,length=10),c(23600,65400,51200,54100)))\nList_Data<-list(Person_Count=Person_Count,\n                Money_Count=Money_Count)\n\n#=====================markPoint==================#\n#准备绘制作点用的前10城市数据，并设置颜色。\nmarkpoint_data<-data.frame(point=c(\"济南\",\"武汉\",\"蚌埠\",\"乌鲁木齐\",\n                                   \n                                   \"北京\",\"天津\",\"沈阳\",\"菏泽\",\n                                   \n                                   \"广州\",\"贵阳\"),\n                           color=c(\"#FFE4B5\",\"#FFD700\",\"#FFB5C5\",\"#EEEEE0\",\"#A2CD5A\",\"#96CDCD\",\"#8B864E\",\n                                   \"#00868B\",\"#1874CD\",\"#71C671\"))\n\n\n#控制点的主题样式\nmarkpoint_control_theme<-markPointControl(symbol = 'circle',\n                                          \n                                          symbolSize =15,\n                                          \n                                          effect =T,\n                                          \n                                          effectType = 'scale'\n                                          \n)\n\n\n#=====================markLine===================#\n#准备绘制作线条用的前10城市数据,并设置颜色\nmarkline_data <-data.frame(origin=rep(\"上海\",10),\n                           \n                           destination=c(\"济南\",\"武汉\",\"蚌埠\",\"乌鲁木齐\",\n                                         \n                                         \"北京\",\"天津\",\"沈阳\",\"菏泽\",\n                                         \n                                         \"广州\",\"贵阳\"),\n                           \n                           color=c(\"#FFE4B5\",\"#FFD700\",\"#FFB5C5\",\"#EEEEE0\",\"#A2CD5A\",\"#96CDCD\",\"#8B864E\",\n                                   \"#00868B\",\"#1874CD\",\"#71C671\")\n                           \n)\n\nmarkline_control_theme <-markLineControl(symbol='circle',\n                                         symbolSize=c(2,2),\n                                         \n                                         smooth=T,\n                                         \n                                         smoothness=0,\n                                         \n                                         effect=T,\n                                         \n                                         lineWidth=1,\n                                         \n                                         lineType=\"solid\"\n                                         \n)\n#====================================shinyServer============================#\nshinyServer(\n  function(input,output){\n    #=========准备数据=============#\n    #需要绘制地图的数据\n    datasetinput<-reactive(\n      {\n        switch(\n          input$Data,\n          \"Person_Count\"=Person_Count,\n          \"Money_Count\"=Money_Count\n          \n        )\n      }\n    )\n    #绘制地图的主题\n    mainsetinput<-reactive(\n      {\n        switch(\n          input$Data,\n          \"Person_Count\"=\"客户量在中国各地的分布\",\n          \"Money_Count\"=\"借贷总额在中国各地的分布\"\n          \n        )\n      }\n    )\n    #绘制地图的背景\n    colorsetinput<-reactive(\n      {\n        switch(\n          input$Data,\n          \"Person_Count\"=c('#1e90ff','#f0ffff'),\n          \"Money_Count\"=c(\"#EEEEE0\",\"#E0FFFF\")\n          \n        )\n      }\n    )\n    #1:\n    output$view_table=renderTable(\n      {\n        data <-datasetinput()\n        head(data)\n      }\n    )\n    \n    #2:绘制中国地图输出\n    output$chinamap = renderREmap(\n      {\n        datainput<-datasetinput()\n        \n        maininput<-mainsetinput()\n        \n        colorinput<-colorsetinput()\n        \n        remapC(data=datainput,maptype = 'china',title=maininput,\n               markPointData=markpoint_data,markPointTheme=markpoint_control_theme,\n               markLineData=markline_data,markLineTheme=markline_control_theme,\n               color=colorinput)\n      }\n    )\n    \n  }\n)\n",
    "created" : 1510045111904.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "711900280",
    "id" : "C0BB8DF7",
    "lastKnownWriteTime" : 1510045242,
    "last_content_update" : 1510045242985,
    "path" : "~/REmap_China/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}